# 입실 체크 해주세요 !! 😀

# 금일 수업 과정
1. 코드 리팩토링
2. 수정 파트 설정 -> 똑같이 모달창이 뜹니다.
  - 특정 차에 삭제 버튼 만든 것처럼 Edit 버튼 만들어요.
  - 모달 창이 뜨는데, 그건 생성 부분에서 구현한 방식을 그대로 사용할겁니다.
  - input 창에 기존 차의 데이터가 그대로 나와있도록 할겁니다.
  - 필요한 부분만 수정을 하면, PUT 요청을 보내도록 할겁니다.
  - DB가 수정되고, 마찬가지로 cache와 다른지 체크해서 브라우저 최신화를 하게 될겁니다.

3. 쇼핑리스트에서 했던 것처럼 몇몇 HTML 태그를 mui로 대체할겁니다. Button / TextField로.
4. mui icon을 적용

# Refactoring 
기능은 동일하게 가져가면서 내부의 로직을 수정(개선)한 방식.

수정 기능을 구현할 때 C 에서 만들었던 모달창을 그대로 사용할겁니다. 그렇다면 C에서 만든 걸 그냥 ctrl + c / v 해서 복사 붙여넣기한다면 동일한 기능을 하는 코드가 중복적으로 사용될겁니다. 그래서 아예 컴포넌트를 하나 만들어서 그것을 C에도 쓰고 U에도 쓸 예정입니다.

TextField를 자체 컴포넌트로 분할한 다음에 New Car / Edit 폼에서 사용하는 것을 목표로 할겁니다.

components 폴더에 CarDialogContent.tsx 생성. -> 초기화
프롭을 이용하여 car 객체와 handleChange 함수를 전달하기 위해서 DialogFormProps라는 새로운 자료형도 생성할겁니다.
근데 얘는 모달(Dialog) 내에서만 사용할거라 types.ts에는 쓰지 않을겁니다.

이상의 지시사항을 코드로 구현한 것이

```tsx
//CarDialogContent.tsx
import { Car } from "../types";

type DialogFormProps = {
  car: Car;
  handleChange: (event : React.ChangeEvent<HTMLInputElement>) => void;
}

export default function CarDialogContent({ car, handleChange } : DialogFormProps) {

  return (<></>);
}
```

그리고 CarDialogContent에 AddCar 컴포넌트의 `<DialogContent>` 태그 부분을 전체 복사하여 붙여넣고,
AddCar에서는 DialogContent 태그를 전체 삭제합니다. 이를 CarDialogContent로 대체했습니다.
예시코드는 다음과 같습니다.
주석 부분을 풀고 실행시켜가면서 비교하시기 바랍니다.

```tsx
// AddCar.tsx
import { Dialog, DialogActions, DialogContent, DialogTitle } from "@mui/material";
import { Car } from "../types";
import { useState } from "react";
import { useMutation, useQueryClient } from "@tanstack/react-query";
import { addCar } from "../api/carapi";
import CarDialogContent from "./CarDialogContet";

export default function AddCar() {
  const [ open, setOpen ] = useState(false);
  const [ car, setCar ] = useState<Car>({
    brand: '',
    model: '',
    color: '',
    registrationNumber: '',
    modelYear: 0,
    price: 0,
  });
  const queryClient = useQueryClient();

  const { mutate } = useMutation(addCar, {
    onSuccess: () => {
      queryClient.invalidateQueries(['cars']);
    },
    onError: (err) => console.log(err),
  });

  // 자동차를 저장하고 모달 폼을 닫을 수 있도록 할겁니다.
  const handleSave = () => {
    mutate(car);
    setCar({
      brand: '',
      model: '',
      color: '',
      registrationNumber: '',
      modelYear: 0,
      price: 0,
    });
    handleClose();
  }


  const handleClickOpen = () => setOpen(true);

  const handleClose = () => setOpen(false);

  const handleChange = (event : React.ChangeEvent<HTMLInputElement>) => 
  {
    setCar({...car, [event.target.name]: event.target.value})
  }
  
  return(
    <>
      <button onClick={handleClickOpen}>New Car</button>
      <Dialog open={open} onClose={handleClose}>
        <DialogTitle>New Car</DialogTitle>
        <CarDialogContent car={car} handleChange={handleChange} />

        {/* <DialogContent>
          <input placeholder="Brand" name="brand" value={car.brand} onChange={handleChange} /><br />
          <input placeholder="Model" name="model" value={car.model} onChange={handleChange} /><br />
          <input placeholder="Color" name="color" value={car.color} onChange={handleChange} /><br />
          <input placeholder="Reg.nr" name="registrationNumber" value={car.registrationNumber} onChange={handleChange} /><br />
          <input placeholder="Year" name="modelYear" value={car.modelYear} onChange={handleChange} /><br />
          <input placeholder="Price" name="price" value={car.price} onChange={handleChange} /><br />
        </DialogContent> */}
        <DialogActions>
          <button onClick={handleClose}>Cancel | 취소</button>
          <button onClick={handleSave}>Save | 저장</button>
        </DialogActions>
      </Dialog>
    </>
  );
}
```
